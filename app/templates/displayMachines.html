<!DOCTYPE html>
<html lang="en">
    <head>
        <link rel="stylesheet" href="{{ url_for('static', filename='css/machineGrid.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/displayMachines.css') }}">
        <title>Display Machines</title>
    </head>
    <body>
        {% if filter == 'available' %}
            <h2>Available Machines</h2>
        {% elif filter == 'unavailable' %}
            <h2>Unavailable Machines</h2>
        {% endif %}

        <!--TODO filter functionality-->
        <div class="filterButtons">
            <button onclick="toggle(this)" class="toggleButton" id="washerToggle" type="button">Washer</button>
            <button onclick="toggle(this)" class="toggleButton" id="dryerToggle" type="button">Dryer</button>
            <select class="dropdownSelect" id="roomDropdown" name="preferredRoom">
                {% for room in laundryRoomList %}
                    <option value='{{ room }}'>{{ room }}</option>
                {% endfor %}
            </select>
            <br>
        {% if filter == 'unavailable' %}
            <form oninput="timeSliderValue.value=parseInt(timeInput.value) + ' minutes'">
                <label for="timeInput" class="timeSlider">Max time remaining:</label>
                <input type="range" id="timeInput" class="timeSlider" min="0" max="60" value="60">
                <output id="timeSliderValue" for="timeInput" class="timeSlider">60 minutes</output>
            </form>
        {% endif %}
        </div>


        {% for machine in allMachines | sort(attribute='time-remaining') %}
            {% if( (filter == 'available' and machine['available']) or (filter == 'unavailable' and not machine['available']) ) %} <!--apply filters-->
                <!--TODO implement filtering from above-->
                {% if machine['available'] %}
                <div class="availableMachineBlock">
                    <h3>Available</h3>
                    <div class="backgroundHighlight"></div>
                {% else %}
                <div class="unavailableMachineBlock">
                    <h3>Unavailable</h3>
                    <p class="timeRemaining">{{ machine['time-remaining'] }} minutes remaining</p>
                    <progress class="timeRemaining" id="progressBar" value="{{ 60 - machine['time-remaining'] }}" max="60"></progress><br>
                {% endif %}

                {% if machine['type'] == 'washer' %}
                    <img src="{{ url_for('static', filename='images/washer_icon.png') }}">
                {% else %}
                    <img src="{{ url_for('static', filename='images/dryer_icon.png') }}">
                {% endif %}

                <p class="machineType">{{ machine['type'] | capitalize }}</p>
                <p class="machineLocation">{{ machine['location'] }}</p>

                {% if machine['available'] %}
                    <!--TOOD button functionality-->
                    <button type="button">Check Out</button>
                {% endif %}
                </div>
            {% endif %}
        {% endfor %}
   
        <script src="{{ url_for('static', filename='js/displayMachines.js') }}"></script>
    </body>
</html>